#################################################################
## Automations Entertainment area
#################################################################

 - alias: Entertainment area playing spotify
   trigger:
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'playing'
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'idle'
   condition:
     condition: template
     value_template: >-
       {%- if is_state_attr("media_player.entertainment_area", "app_name", "Spotify") -%}
         true
       {%- endif -%}
   action:
     - service: homeassistant.turn_on
       entity_id: scene.living_spotify
     - service: media_player.turn_on
       entity_id: media_player.receiver
     - service: media_player.select_source
       data:
         entity_id: media_player.receiver
         source: cd_tv_cd

 - alias: Entertainment area playing netflix
   trigger:
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'playing'
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'idle'
   condition:
     condition: and
     conditions:
       - condition: numeric_state
         entity_id: sensor.livingroom_lux
         below: 160
       - condition: template
         value_template: >-
           {%- if is_state_attr("media_player.entertainment_area", "app_name", "Netflix") -%}
             true
           {%- endif -%}
   action:
     - service: homeassistant.turn_on
       entity_id: scene.living_netflix
     - service: media_player.turn_on
       entity_id: media_player.receiver
     - service: media_player.select_source
       data:
         entity_id: media_player.receiver
         source: cd_tv_cd

 - alias: Entertainment area playing mac
   trigger:
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'playing'
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'idle'
   condition:
     condition: and
     conditions:
       - condition: numeric_state
         entity_id: sensor.livingroom_lux
         below: 160
       - condition: template
         value_template: >-
           {%- if is_state_attr("media_player.entertainment_area", "app_name", "Default Media Receiver") -%}
             true
           {%- endif -%}
   action:
     - service: homeassistant.turn_on
       entity_id: scene.living_netflix
     - service: media_player.turn_on
       entity_id: media_player.receiver
     - service: media_player.select_source
       data:
         entity_id: media_player.receiver
         source: cd_tv_cd

 - alias: Entertainment area playing youtube
   trigger:
     - platform: state
       to: 'playing'
       entity_id: media_player.entertainment_area
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'idle'
   condition:
     condition: and
     conditions:
       - condition: numeric_state
         entity_id: sensor.livingroom_lux
         below: 160
       - condition: template
         value_template: >-
           {%- if is_state_attr("media_player.entertainment_area", "app_name", "Youtube") -%}
             true
           {%- endif -%}
   action:
     - service: homeassistant.turn_on
       entity_id: scene.living_youtube
     - service: media_player.turn_on
       entity_id: media_player.receiver
     - service: media_player.select_source
       data:
         entity_id: media_player.receiver
         source: cd_tv_cd

 - alias: Entertainment area playing soundcloud
   trigger:
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'playing'
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'idle'
   condition:
     - condition: template
       value_template: >-
         {%- if is_state_attr("media_player.entertainment_area", "app_name", "SoundCloud") -%}
           true
         {%- endif -%}
   action:
     - service: homeassistant.turn_on
       entity_id: scene.living_soundcloud
     - service: media_player.turn_on
       entity_id: media_player.receiver
     - service: media_player.turn_on
       entity_id: media_player.samsung_tv_remote
     - service: media_player.select_source
       data:
         entity_id: media_player.receiver
         source: cd_tv_cd

 - alias: Entertainment area paused
   trigger:
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'paused'
   condition:
     - condition: numeric_state
       entity_id: sensor.livingroom_lux
       below: 160
   action:
     service: homeassistant.turn_on
     entity_id: scene.living_normal

 - alias: Entertainment area off
   trigger:
     - platform: state
       entity_id: media_player.entertainment_area
       to: 'off'
   condition:
     - condition: numeric_state
       entity_id: sensor.livingroom_lux
       below: 160
   action:
     - service: homeassistant.turn_on
       entity_id: scene.living_normal

 - alias: Turn on living light when there is movement
   trigger:
     - platform: state
       entity_id: sensor.livingroom_motion
       to: '1'
   condition:
     condition: and
     conditions:
       - condition: numeric_state
         entity_id: sensor.livingroom_lux
         below: 160
       - condition: state
         entity_id: media_player.entertainment_area
         state: 'off'
   action:
     service: homeassistant.turn_on
     entity_id: scene.living_normal

 - alias: Turn off living light 30 minutes after last movement
   trigger:
     - platform: state
       entity_id: sensor.livingroom_motion
       to: '0'
       for:
         minutes: 30
   condition:
     - condition: state
       entity_id: media_player.entertainment_area
       state: 'off'
     - condition: time
       after: '00:00:00'
       before: '18:00:00'
   action:
     - service: homeassistant.turn_off
       entity_id: group.living_light_group
     - service: homeassistant.turn_on
       entity_id: scene.living_corneroff

 - alias: Turn off living light 1 hour after last movement
   trigger:
     - platform: state
       entity_id: sensor.livingroom_motion
       to: '0'
       for:
         minutes: 60
   condition:
     - condition: state
       entity_id: media_player.entertainment_area
       state: 'off'
     - condition: time
       after: '18:00:00'
       before: '00:00:00'
   action:
     - service: homeassistant.turn_off
       entity_id: group.living_light_group
     - service: homeassistant.turn_on
       entity_id: scene.living_corneroff